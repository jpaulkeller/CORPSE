Some of the classes in here originally came from Frellco's Emo plugin.